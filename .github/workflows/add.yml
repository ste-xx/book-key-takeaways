name: Add book to collection

on:
  workflow_dispatch:
    inputs:
      title:
        type: string
        description: "title for the new book"
        required: true
      image_url:
        type: string
        description: "image url"
        required: true
      header:
        type: string
        description: "given chapter"
        required: true

jobs:
  describe:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - run: echo ::set-output name=lowerCase::$(cat README.md | tr '[:upper:]' '[:lower:]')
        id: readme
      - run: echo ::set-output name=lowerCase::$(echo "${{ github.event.inputs.header }}" | tr '[:upper:]' '[:lower:]')
        id: header

      - if: ${{ !contains(steps.readme.outputs.lowerCase, join('### ', steps.header.outputs.lowerCase)) }}
        run: echo 'add header, add table (| Cover         | Title         | Link  |)'
#      - run: "if header not exists: add header, add table (| Cover         | Title         | Link  |)"
#      - run: "transform title to lowercase_snakecase "
#      - run: "add entry to header/table (transformed_title/cover.jpg | title | transformed_title/takeaways.md)"
#      - run: "wget image_url -> transformed_title/cover.jpg"
#      - run: "create transformed_title/takeaways.md"